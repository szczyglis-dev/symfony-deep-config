# Symfony Deep Config

Current version: 1.2

Small and very useful service for Symfony 4 and 5 offering deep nesting of configuration files with easy access to them using simple dotted (.) notation.

### Service works with Symfony 4 and 5 (repository includes version 5 of framework)

Deep Config allows for unlimited nesting of configuration files and quick access to them in a very friendly way using dotted notation. It allows you to quickly navigate through multi-level configurations consisting of many files and arrays in a transparent way using a simple syntax. Deep Config also offers easy use of the configuration stored in database. Twig extension is also included.


## Usage Example:
```
<?php

namespace App\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use App\Service\DeepConfig;

class AppController extends AbstractController
{
	public function index(DeepConfig $config) {
	
		$house = $config->get('world.country.city.street.house');

		return $this->render('index.html.twig', [
			'house' => $house
		]);
	}
}
```

`world.country.city.street.house` is handly traverse path telling Deep Config where to find your config parameter.
Let's imagine directory structure in `/config` directory:

```
/config
 |--- world
	  |---country
		  |---city
			  |--- street.yaml
```

...and if the `street.yaml` has an array with key named `house`:


`house: "some_house"`

then `world.country.city.street.house` key will returns you a `some_house` value from here. Easy! Deep Config can navigate through the directory structure to get the best matching path and it can do the same with the arrays contained in the configuration files. With Deep Config you can nesting this structure and also arrays structure in yaml files as deep as you want.

### Another example:

If there is a `country.yaml` file placed in the `/config/world` directory:

```
/config
 |--- world
	  |---country.yaml
```

and if the `country.yaml` looks like this:

```
city:
	street:
		house: "some_house"
```

then `world.country.city.street.house` key will returns you a `some_house` value from this place.

## Using in Twig templates

Repository also includes Twig extension, so you can use Deep Config in templates directly via `conf` function.

templates/some_template.html.twig:
```
<body>

{{ conf('world.country.city.street.house') }}

</body>
```

There are more examples in repository - just deploy included Symfony 5 project and open default `/` URL path in your browser to check more.

## Screenshot:
![bc2](https://user-images.githubusercontent.com/61396542/75373764-36d8ba80-58cb-11ea-8e96-f24a19b23c4e.png)

## Database storage
Another feature of Deep Config is quick and easy database parameters storage. It can stores the same config keys in database and returning them transparenly via the same `get` method. Values from database replace the local ones stored in yaml files. In other words if you have `world.country.city.street.house` key stored in database then Deep Config will return this parameter from database at first. Storing parameters in database is also easy:

`$config->set('some_key', 'some_value');`

Deleting parameters is easy too:

`$config->del('some_key');`

If you don't need database support then you can disable database storage by:

`$config->useDatabase(false);`

or in a better way by argument specified in your `config/services.yaml`:

```
services:
	App\Service\DeepConfig:
	        arguments:
	            $projectDir: '%kernel.project_dir%'
	            $useDatabase: false
```




## Repository contents:

## Main files:

`src/Service/DeepConfig.php` - Deep Config service

`src/Entity/DeepConfig.php` - Deep Config Doctrine entity

`src/Repository/DeepConfigRepository.php` - Deep Config Doctrine repository

`src/Controller/ExampleController.php` - example controller

`src/Twig/TwigExtension.php` - extension for Twig

`templates/example.html.twig` - simple template with examples

`config/services.yaml` - `$projectDir` and `$useDatabase` arguments must be specified here

`tests/Service/DeepConfigTest.php` - Deep Config phpunit tests

## Example config files:

`config/level1.yaml`

`config/second/level2.yaml`

`config/second/third/level3.yaml`

## CRUD (generated by `make:crud`, available from `/deep/config` URL path):

`src/Controller/DeepConfigController.php`

`src/Form/DeepConfigType.php`

`templates/deep_config/*`


## Installation:

```
$ composer install
$ bin/console doctrine:migrations:migrate
```

**Important:** remember that you must specify these two arguments in your `config/services.yaml` when including service into your project:

```
services:
	App\Service\DeepConfig:
	        arguments:
	            $projectDir: '%kernel.project_dir%'
	            $useDatabase: true
```



 
### Symfony Deep Config is free to use but if you liked then you can donate project via BTC: 

**1LK9tDPBuBFXCKUThFWXNvdcdJ4gzx1Diz**

or by PayPal:
 **[https://www.paypal.me/szczyglinski](https://www.paypal.me/szczyglinski)**


Enjoy!


MIT License | 2020 Marcin 'szczyglis' Szczygli≈Ñski

https://github.com/szczyglis-dev/symfony-deep-config

Contact: szczyglis@protonmail.com
